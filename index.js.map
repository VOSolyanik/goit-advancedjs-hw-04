{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const fetchImages = async (searchText, page, pageSize = 15) => {\n  const searchParams = new URLSearchParams({\n    key: '48213456-ebc0266b477643e50c8486310',\n    q: searchText.trim(),\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: pageSize,\n  });\n\n  return axios(`https://pixabay.com/api/`, {\n    params: searchParams\n  })\n    .then(response => {\n      if (response.status !== 200) {\n        throw new Error(response.status);\n      }\n      return response.data;\n    })\n    .then(data => {\n      return {\n        results: data.hits,\n        total: data.totalHits\n      }\n    })\n};","import iziToast from 'izitoast';\n\nconst getGalleryItemTemplate = ({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  return `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=${largeImageURL}>\n      <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n      <ul class=\"gallery-item-info\">\n        <li>\n          <p>Likes</p>\n          <p>${likes}</p>\n        </li>\n        <li>\n          <p>Views</p>\n          <p>${views}</p>\n        </li>\n        <li>\n          <p>Comments</p>\n          <p>${comments}</p>\n        </li>\n        <li>\n          <p>Downloads</p>\n          <p>${downloads}</p>\n        </li>\n      </ul>\n    </a>\n  </li>`;\n};\n\nexport const renderGallery = (container, images) => {\n  if (!images) return (container.innerHTML = '');\n\n  const markup = images\n    .map(image => {\n      return getGalleryItemTemplate(image);\n    })\n    .join('');\n\n  container.insertAdjacentHTML('beforeend', markup);\n\n  scrollGallery(container, 2);\n};\n\nexport const scrollGallery = (container, items) => {\n  const { height } = container\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  window.scrollBy({\n    top: height * items,\n    behavior: 'smooth',\n  });\n};\n\nexport const renderError = message => {\n  iziToast.error({\n    message,\n    position: 'topRight',\n  });\n};\n\nexport const renderInfo = message => {\n  iziToast.info({\n    message,\n    position: 'topRight',\n  });\n};\n\nexport const toggleVisibility = (loader, isVisible) => {\n  if (isVisible) {\n    loader.classList.remove('hidden');\n  } else {\n    loader.classList.add('hidden');\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport { fetchImages } from './js/pixabay-api';\nimport { renderError, renderGallery, renderInfo, toggleVisibility } from './js/render-functions';\n\nconst searchFormElement = document.querySelector('.search-form');\nconst loadMoreElement = document.querySelector('.load-more');\nconst loaderElement = document.querySelector('.loader');\nconst galleryContainer = document.querySelector('.gallery');\n\nconst simpleLightboxInstance = new SimpleLightbox('.gallery a.gallery-link', {\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nconst pageSize = 15;\nlet currentPage = 1;\nlet searchQuery = '';\n\nconst searchHandler = async (event) => {\n  event.preventDefault();\n\n  searchQuery = event.target.elements['search'].value;\n  currentPage = 1;\n  // clear gallery if new search\n  renderGallery(galleryContainer);\n\n  await loadImagesPage(currentPage);\n\n  searchFormElement.reset();\n}\n\nconst loadMoreHandler = async () => {\n  currentPage += 1;\n  await loadImagesPage(currentPage);\n}\n\nconst loadImagesPage = async (page) => {\n  toggleVisibility(loaderElement, true);\n  toggleVisibility(loadMoreElement, false);\n\n  try {\n    const {results: images, total} = await fetchImages(searchQuery, page, pageSize);\n\n    if(!images.length) {\n      renderError('Sorry, there are no more images to load!');\n    } else {\n      renderGallery(galleryContainer, images);\n      simpleLightboxInstance.refresh();\n      // show load more button if there are more images to load\n      if (pageSize * page < total) {\n        toggleVisibility(loadMoreElement, true);\n      } else if (page !== 1) {\n        renderInfo('We\\'re sorry, but you\\'ve reached the end of search results.')\n      }\n    }\n  } catch {\n    renderError('Sorry, something went wrong. Please try again later!');\n  } finally {\n    toggleVisibility(loaderElement, false);\n  }\n}\n\nsearchFormElement.addEventListener('submit', searchHandler);\nloadMoreElement.addEventListener('click', loadMoreHandler);"],"names":["fetchImages","searchText","page","pageSize","searchParams","axios","response","data","getGalleryItemTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderGallery","container","images","markup","image","scrollGallery","items","height","renderError","message","iziToast","renderInfo","toggleVisibility","loader","isVisible","searchFormElement","loadMoreElement","loaderElement","galleryContainer","simpleLightboxInstance","SimpleLightbox","currentPage","searchQuery","searchHandler","event","loadImagesPage","loadMoreHandler","total"],"mappings":"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"}